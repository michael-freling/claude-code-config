# Claude Code Configuration

This directory contains custom commands, skills, and templates to enhance Claude Code's ability to work with this codebase.

## Quick Start

### First Time Setup

When starting work on a new project or subproject:

```bash
# 1. Document the project's design patterns
/document-design

# 2. Review the generated design.md
# Read .claude/design.md to understand the project

# 3. Start implementing features
/skill feature-dev
```

## Directory Structure

```
/
├── commands/              # Custom slash commands
│   └── document-design.md # Analyzes and documents project conventions
├── skills/               # Reusable development skills
│   ├── feature-dev.md    # Skill for implementing features
│   └── README.md         # Skills documentation
├── templates/            # Templates for generated files
│   └── design.md.template # Template for design documentation
└── design.md            # Project-specific design docs (generated by /document-design)
```

## Available Commands

### /document-design

**Purpose**: Analyzes your codebase and creates comprehensive design documentation.

**What it does**:
- Detects languages, frameworks, and project structure
- Analyzes existing code patterns and conventions
- Documents naming conventions and coding standards
- Captures architecture patterns and design decisions
- Creates `.claude/design.md` with all findings

**When to use**:
- First time working on a project
- When project conventions are unclear
- After major architectural changes
- In each subproject directory for monorepos
- When onboarding new team members (human or AI)

**Output**: Creates or updates `.claude/design.md`

## Available Skills

### feature-dev

**Purpose**: Comprehensive skill for adding or updating features following best practices.

**Supports**:
- TypeScript with extensive type safety patterns
- Next.js (App Router and Pages Router)
- Go with standard layouts and idioms
- Protocol Buffers with versioning

**Key Features**:
- Automatically reads and follows `.claude/design.md`
- Language-specific best practices with examples
- Complete workflow demonstrations
- Common pitfalls with bad vs good examples
- Quick reference checklists
- Command reference for each language

**Usage**: `/skill feature-dev`

## Workflow

### Recommended Development Flow

```
┌─────────────────────┐
│  /document-design   │  Analyze codebase and create design.md
└──────────┬──────────┘
           │
           ▼
┌─────────────────────┐
│ Review design.md    │  Understand project conventions
└──────────┬──────────┘
           │
           ▼
┌─────────────────────┐
│ /skill feature-dev  │  Implement features following design.md
└──────────┬──────────┘
           │
           ▼
┌─────────────────────┐
│ Update design.md    │  Document new patterns if needed
└─────────────────────┘
```

### For Monorepos

In a monorepo with multiple subprojects:

1. Run `/document-design` in the repository root (for shared conventions)
2. Run `/document-design` in each subproject directory (for specific patterns)
3. When implementing features, the skill will check:
   - Subproject `.claude/design.md` (highest priority)
   - Repository root `.claude/design.md` (fallback)

## The design.md File

### What Goes in design.md

The `design.md` file captures:

**Project Overview**:
- Languages, frameworks, dependencies

**Directory Structure**:
- What each directory contains
- Organization principles

**Coding Standards**:
- Naming conventions (files, variables, types, constants)
- Code organization patterns
- Formatting rules

**Architecture**:
- Overall architectural pattern
- Layer organization and dependencies
- Data flow

**Best Practices**:
- Error handling patterns
- Testing conventions
- Language-specific patterns
- API design guidelines

**Examples**:
- Real code snippets from the project
- File references showing patterns

### Why design.md Matters

1. **Consistency**: Ensures Claude Code follows your exact patterns
2. **Efficiency**: Avoids analyzing the codebase every time
3. **Accuracy**: Documents actual patterns, not assumptions
4. **Onboarding**: Helps new developers (AI or human) understand conventions
5. **Evolution**: Tracks how patterns change over time

## Best Practices

### Keep design.md Updated

Update `.claude/design.md` when:
- Adding new architectural patterns
- Changing naming conventions
- Introducing new frameworks or libraries
- Refactoring major components
- Establishing new best practices

### Project-Specific Over General

The feature-dev skill follows this priority:

1. **Subproject design.md** (if in a monorepo)
2. **Root design.md** (project-specific)
3. **General best practices** (language-specific defaults)

This ensures project conventions always take precedence.

### Use Concrete Examples

In design.md, always prefer:
- Real code snippets from the codebase
- Actual file paths and line numbers
- Specific examples over general descriptions

## Customization

### Adding Your Own Commands

Create new commands in `.claude/commands/`:

```markdown
---
description: Brief description of what this command does
---

# Command Name

Detailed instructions for Claude Code on what to do...
```

### Adding Your Own Skills

Create new skills in `.claude/skills/`:

```markdown
# Skill Name

Overview of what this skill does...

## When to Use

List scenarios...

## Process

Step-by-step instructions...
```

## Templates

### design.md.template

Located at `.claude/templates/design.md.template`, this provides:
- Structure for design documentation
- Section templates
- Example content
- Placeholders for project-specific information

The `/document-design` command uses this as a reference but adapts it to the actual project.

## Integration with Claude Code

### How Commands Work

When you run `/document-design`:
1. Claude Code reads `.claude/commands/document-design.md`
2. Follows the instructions to analyze the codebase
3. Creates `.claude/design.md` with findings

### How Skills Work

When you use `/skill feature-dev`:
1. Claude Code loads `.claude/skills/feature-dev.md`
2. First step: reads `.claude/design.md` (if it exists)
3. Follows best practices from both sources
4. Implements features consistently

### The Power of Combining Them

```
design.md (project patterns) + feature-dev skill (implementation guide) = consistent code
```

## Examples

### Example: TypeScript Project

```bash
# Initial setup
cd my-typescript-project
/document-design

# This creates .claude/design.md with:
# - TypeScript configuration analysis
# - Import patterns
# - Type definition conventions
# - File organization rules
# - Testing patterns

# Now implement a feature
/skill feature-dev
# Feature-dev reads design.md and follows your exact patterns
```

### Example: Go Project

```bash
# Initial setup
cd my-go-project
/document-design

# This creates .claude/design.md with:
# - Package structure
# - Interface patterns
# - Error handling conventions
# - Testing patterns
# - Go module configuration

# Now implement a feature
/skill feature-dev
# Feature-dev follows your Go project's specific patterns
```

### Example: Monorepo

```bash
# Document root patterns
cd my-monorepo
/document-design

# Document subproject patterns
cd packages/web-app
/document-design

# Now when implementing features in web-app:
/skill feature-dev
# Follows packages/web-app/.claude/design.md first,
# then falls back to root .claude/design.md
```

## Troubleshooting

### design.md Doesn't Match Actual Code

If you find design.md is outdated:
1. Run `/document-design` again to refresh it
2. Manually edit `.claude/design.md` with current patterns
3. Keep it updated as you make changes

### Feature-dev Not Following Patterns

Ensure:
1. `.claude/design.md` exists and is current
2. Patterns in design.md are clear and specific
3. Code examples in design.md are accurate

### Monorepo Confusion

For clarity in monorepos:
1. Create design.md in root for shared patterns
2. Create design.md in each subproject for specific patterns
3. Mention in comments which patterns are subproject-specific

## Contributing

To improve these tools:

1. Update command instructions in `.claude/commands/`
2. Enhance skill guides in `.claude/skills/`
3. Refine templates in `.claude/templates/`
4. Keep this README updated

## Summary

This `.claude` directory creates a powerful system:

1. **Document** project patterns with `/document-design`
2. **Implement** features consistently with `/skill feature-dev`
3. **Maintain** patterns by keeping design.md current

The result: Claude Code works with your codebase as if it deeply understands your conventions, because it does - they're documented in `.claude/design.md`.
